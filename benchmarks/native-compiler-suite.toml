# Native compiler performance contract for LLVM roadmap baseline.
#
# This suite keeps the existing benchsuite command contract, but adds
# machine-readable native compiler SLOs + weighted Rust/Go competitiveness scoring.

[performance_contract]
baseline_path = "benchmarks/native-compiler-baselines.json"
candidate_target = "interpreter"
reference_targets = ["tonic_interpreter_baseline"]
relative_budget_pct = 50
pass_threshold = 0.82

  [performance_contract.metric_weights]
  latency_p50 = 0.35
  latency_p95 = 0.25
  rss = 0.20
  artifact_size = 0.10
  compile_latency = 0.10

  [performance_contract.slo]
  startup_p50_ms = 50
  runtime_p50_ms = 15
  runtime_p95_ms = 30
  rss_kb = 30720
  artifact_size_bytes = 12000000
  compile_latency_ms = 3000

[[workload]]
name = "check_parse_control_flow"
command = ["check", "examples/parity/06-control-flow/for_multi_generator.tn"]
mode = "cold"
threshold_p50_ms = 10
threshold_p95_ms = 20
threshold_rss_kb = 30720
weight = 1.2
category = "startup"

[[workload]]
name = "check_module_load_project"
command = ["check", "examples/parity/07-modules/project_multifile_pipeline"]
mode = "cold"
threshold_p50_ms = 12
threshold_p95_ms = 24
threshold_rss_kb = 30720
weight = 1.2
category = "startup"

[[workload]]
name = "run_module_load_project"
command = ["run", "examples/parity/07-modules/project_multifile_pipeline"]
mode = "cold"
threshold_p50_ms = 14
threshold_p95_ms = 28
threshold_rss_kb = 30720
weight = 1.0
category = "module_load"

[[workload]]
name = "run_control_flow_multi_generator"
command = ["run", "examples/parity/06-control-flow/for_multi_generator.tn"]
mode = "warm"
threshold_p50_ms = 8
threshold_p95_ms = 16
threshold_rss_kb = 30720
weight = 1.3
category = "control_flow"

[[workload]]
name = "run_control_flow_for_into"
command = ["run", "examples/parity/06-control-flow/for_into.tn"]
mode = "warm"
threshold_p50_ms = 8
threshold_p95_ms = 16
threshold_rss_kb = 30720
weight = 1.0
category = "control_flow"

[[workload]]
name = "run_error_result_pipeline"
command = ["run", "examples/parity/08-errors/question_operator_success.tn"]
mode = "warm"
threshold_p50_ms = 8
threshold_p95_ms = 16
threshold_rss_kb = 30720
weight = 0.8
category = "runtime"

[[workload]]
name = "check_json_transform_shape"
command = ["check", "examples/parity/03-collections/map_literal_single_entry.tn"]
mode = "warm"
threshold_p50_ms = 8
threshold_p95_ms = 16
threshold_rss_kb = 30720
weight = 0.9
category = "json_transform"

[[workload]]
name = "check_file_pipeline_project"
command = ["check", "examples/parity/07-modules/project_multifile_pipeline"]
mode = "cold"
threshold_p50_ms = 12
threshold_p95_ms = 24
threshold_rss_kb = 30720
weight = 1.0
category = "file_io"

[[workload]]
name = "check_subprocess_host_interop"
command = ["check", "tests/fixtures/host_call/sum.tn"]
mode = "warm"
threshold_p50_ms = 8
threshold_p95_ms = 16
threshold_rss_kb = 30720
weight = 0.8
category = "subprocess"
