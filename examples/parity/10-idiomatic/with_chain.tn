defmodule Demo do
  def run() do
    {fetch_both(), fetch_failure_reason()}
  end

  defp fetch_both() do
    with {:ok, a} <- {:ok, 10},
         {:ok, b} <- {:ok, 20} do
      a + b
    end
  end

  defp fetch_failure_reason() do
    with {:ok, _a} <- {:ok, 10},
         {:ok, _b} <- {:error, :not_found} do
      :success
    else
      {:error, reason} -> reason
      _ -> :unknown
    end
  end
end
